---
title: 组件编写规范
sidebar: true
---

## 前言

组件化思维现已成为前端开发中的主流，它不仅提高开发效率，同时也降低了组件和项目的维护成本。

## 组件开发主要遵循规范

* 组件的设计原则
* 组件的职能划分
* 组件设计的边界

### 组件的设计原则

1. 标准性：任何一个组件都应该遵守一套标准，不同的开发人员据此标准开发出一套标准统一的组件
2. 独立性：遵循单一职责原则，保持组件的纯粹性、细粒度；属性配置等API对外开放，组件内部状态对外封闭，尽可能的少与业务耦合
3. 复用性：不要强迫一个组件依赖他们不需要的东西，基于单一职责原则，可以尽可能的无副作的拆装组件
4. 易用性：统一命名标准，state、props属性命名要见名知意，尽量减少不必要的参数设置，降低使用和维护难度
5. 安全性：避免通过ref操作子组件、避免暴露组件内部实现
6. 高效性：避免写重复代码，如果出现相同代码超过三次及以上，可以进行抽象设计
7. 可测试性：组件编写也要考虑后续代码的单元测试、ui测试等测试环境，提高代码质量和稳定性

### 组件的职能划分

1. 基础组件：比如很多优秀的UI组件库：antd、naive-ui、element-ui，我们只需要调用API便能满足大部分的业务场景；也包含一些基础低耦合、职责单一的业务组件
2. 容器型组件：常见的是路由容器组件、页面容器组件等；涉及到的业务包含：
  * 集中/统一的状态管理，向其他展示型/容器型组件提供数据（充当数据源）和行为逻辑处理（接收回调）
  * 业务模块内子组件的通信等统筹处理，充当子级组件通信的状态中转站
3. layout组件：主要涉及到的业务是对项目及页面的布局划分和排版
4. 表单组件：主要处理表单的排版、数据的验证、数据的提交等业务
5. 展示性组件：不和数据强绑定，只负责于特定结构的数据展示。也可以提供定制化的信息展示api
6. 业务组件：具体业务快功能的组件，与业务代码耦合比较高，具体业务具体设计
7. 高阶组件：高阶组件可以看做是函数式编程中的组合，可以把高阶组件看做是一个函数，他接收一个组件作为参数，并返回一个功能增强的组件

### 组件设计的边界

  物极必反，跃跃欲试前，思考以下几个问题以引导完善组件的设计

1. 层级不宜嵌套超过三层，切勿过度设计。超过三层之后可见组件的数据传递的过程就会变得越复杂
2. 这个组件可否（有必要）再分？
  * 划分粒度的根据实际情况权衡，太小会提升维护成本，太大又不够灵活和高复用性
  * 每一个组件都应该有其独特的划分目的的，有的是为了复用实现，有的是为了封装复杂度清晰业务实现
  * 组件划分的依据通常是业务逻辑、功能，要考虑各组件之间的关系是否明确，及可复用度
  * 性能会受到影响吗？如果状态频繁更改，并且当前在一个较大的，关系比较紧密的组件里，为了避免性能受到影响最好抽离出来
  * 是否打破了一个逻辑上有意义的实体，倘若抽离的话，这个代码被复用的概率有多大
3. 组件的依赖是否可再缩减，缩减组件依赖可以提高组件的可复用度
4. 这个组件是否对其它组件造成侵入？
  * 封装性不足或自身越界操作，就可能对自身之外造成了侵入
  * 一个组件不应对其它兄弟组件造成直接影响
5. 需要考虑需要适用的不同场景，在组件接口设计时进行必要的兼容
6. 接口设计符合规范和大众习惯，尽量让别人用起来简单易上手，易上手是指更符合直觉。
